<app-header></app-header>
<div class="container mt-4">
    <h2 class="animated-title">Danh sách chủ đề</h2>

    <!-- Subject slider -->
    <div class="subject-slider mb-3 d-flex align-items-center">
        <button class="arrow-button me-2" (click)="scrollSubjects('left')" [disabled]="isLeftDisabled">
            <i class="fa-solid fa-chevron-left"></i>
        </button>
    
        <div #subjectScrollContainer class="subject-scroll-container flex-grow-1" (scroll)="onScroll()">
            <span *ngFor="let subject of subjectList"
                  class="subject-chip"
                  [class.active]="subject === subjectNameControl.value"
                  (click)="onSelectSubject(subject)">
                {{ subject }}
            </span>
        </div>
    
        <button class="arrow-button ms-2" (click)="scrollSubjects('right')" [disabled]="isRightDisabled">
            <i class="fa-solid fa-chevron-right"></i>
        </button>
    </div>

    <div class="row mb-3 input-find">
        <div class="col-md-6">
            <input type="text" class="form-control input-search" placeholder="Nhập tên khóa học muốn tìm kiếm"
                [formControl]="courseNameControl">
        </div>
        <div class="col-md-6">
            <input type="text" id="ratingInput" class="form-control input-rating" placeholder="Nhập rating tối thiểu muốn tìm kiếm"
                [formControl]="ratingControl">
        </div>
    </div>

    <table class="table table-dark table-bordered text-center">
        <thead>
            <tr>
                <th (click)="sort('courseName')" class="text-center">
                    Khóa học
                    <span class="sort-icon">
                        <i [ngClass]="getSortIcon('courseName')"></i>
                    </span>
                </th>

                <th style="width: 250px;" (click)="sort('offerName')" class="text-center">
                    Người cung cấp
                    <span class="sort-icon">
                        <i [ngClass]="getSortIcon('offerName')"></i>
                    </span>
                </th>

                <th style="width: 200px;" (click)="sort('ratingScore')" class="text-center">
                    Đánh giá
                    <span class="sort-icon">
                        <i [ngClass]="getSortIcon('ratingScore')"></i>
                    </span>
                </th>

                <th style="width: 250px;" (click)="sort('numberOfRegisters')" class="text-center">
                    Học viên đã đăng ký
                    <span class="sort-icon">
                        <i [ngClass]="getSortIcon('numberOfRegisters')"></i>
                    </span>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let r of filteredReviews | paginate: { itemsPerPage: 6, currentPage: p }">
                <td>{{ r.courseName }}</td>
                <td>{{ r.offerName }}</td>
                <td>
                    <div class="star-rating">
                        <div class="star-rating-filled" [style.width.%]="(r.ratingScore / 5) * 100"></div>
                    </div>
                    <span class="rating-number">{{ r.ratingScore.toFixed(1) }}</span>
                </td>
                <td>{{ r.numberOfRegisters }}</td>
            </tr>
        </tbody>
    </table>

    <div class="d-flex justify-content-center mt-3">
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
    </div>
</div>
